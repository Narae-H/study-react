# Redux Toolkit (RTK)
- ReduxëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœ(state)ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì§€ë§Œ, ì „í†µì ìœ¼ë¡œ ì„¤ì •ê³¼ ì½”ë“œê°€ ë³µì¡ -> RTKëŠ” ì´ëŸ° ì—¬ëŸ¬ì›€ì„ í•œë°©ì— í•´ê²°í•´ì£¼ëŠ” ë„êµ¬
- ëª¨ë“  componentsê°€ props ì—†ì´ state ê³µìœ  ê°€ëŠ¥. 

## ê¸°ì¡´ Reduxë¥¼ ì“¸ ë•Œ ìì£¼ ë“±ì¥í•˜ë˜ ë¬¸ì œë“¤
- ìŠ¤í† ì–´ ì„¤ì •ì´ ë³µì¡í•˜ê³  ë¯¸ë“¤ì›¨ì–´, DevTools ë“± ì—¬ëŸ¬ íŒ¨í‚¤ì§€ë¥¼ ì—°ê²°í•´ì•¼ í•¨.
- ë°˜ë³µì ì´ê³  ë§ì€ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œ (action, action creator, reducer ì‘ì„± ë“±) 
- ë¹„ë™ê¸° ë¡œì§ ì‘ì„±ì´ ê¹Œë‹¤ë¡œì›€, ë³„ë„ ì„¤ì •ì´ í•„ìš”

<br/>

# ì„¤ì¹˜
1. Redux ì„¤ì¹˜
```bash
npm install @reduxjs/toolkit react-redux
```

# ìš©ì–´ ì •ë¦¬
| ìš©ì–´                     | ì—­í•                                 |
| ---------------------- | --------------------------------- |
| State                  | í˜„ì¬ ìƒíƒœ **ê°ì²´**                          |
| Action                 | ìƒíƒœ ë³€ê²½ ìš”ì²­ **ê°ì²´**                       |
| Action Creator         | Actionì„ ìƒì„±í•˜ëŠ” **í•¨ìˆ˜**                   |
| Reducer                | Action ê¸°ë°˜ìœ¼ë¡œ ìƒíƒœ ì—…ë°ì´íŠ¸í•˜ëŠ” **í•¨ìˆ˜**          |
| Case Reducer           | íŠ¹ì • Action ìœ í˜•ì—ì„œ ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” ë¶€ë¶„        |
| Slice                  | ìƒíƒœÂ·ì•¡ì…˜Â·ë¦¬ë“€ì„œ ì½”ë“œê°€ í•œ ë¬¶ìŒìœ¼ë¡œ êµ¬ì„±ëœ **ë‹¨ìœ„**       |
| createSlice({})        | Sliceë¥¼ ì •ì˜í•˜ê³  ìë™ ìƒì„±í•´ì£¼ëŠ” **í•¨ìˆ˜**           |
| Store                  | Redux ìƒíƒœ **ì €ì¥ì†Œ**                      |
| configureStore({})     | storeë¥¼ ì‰½ê²Œ êµ¬ì„±í•´ì£¼ëŠ” **í•¨ìˆ˜**                |
| Middleware             | dispatchì™€ reducer ì‚¬ì´ì—ì„œ ë™ì‘í•˜ëŠ” ì¶”ê°€ ê¸°ëŠ¥ |
| RootState, AppDispatch | TypeScriptì—ì„œ state, dispatchì˜ íƒ€ì…  |
| Provider               | Reactì— storeë¥¼ ì œê³µí•˜ëŠ” ì»´í¬ë„ŒíŠ¸           |

<br/>

# ì „ì²´ íë¦„ ìš”ì•½
```
UI í´ë¦­
â†“ 
dispatch(setCategory(['Food'])) 
â†“
action creator
â†“
Action ê°ì²´ ìƒì„± 
â†“
store.dispatch()
â†“
storeê°€ actionê³¼ stateë¥¼ reducerì— ì „ë‹¬ 
â†“
ìƒˆë¡œìš´ state ê³„ì‚° 
â†“
UI ìë™ ë Œë”ë§
```

<br/>

# íŒŒì¼ êµ¬ì¡°
```
mymc-portfolio
â”œâ”€â”€ ğŸ“ app                             # Next.js ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë¼ìš°í„° í´í„°
â”‚   â”œâ”€â”€ ğŸ“„ layout.tsx                  # Redux ì ìš© ë²”ìœ„ ì„¤ì •                  
â”‚   â””â”€â”€ ğŸ“„ StoreProvider.tsx           # í´ë¼ì´ì–¸íŠ¸ ì „ìš© ìŠ¤í† ì–´ í”„ë¡œë°”ì´ë”         
â”‚
â”œâ”€â”€ ğŸ“ redux                           # ìƒíƒœ(Redux) ì¤‘ì‹¬ ë¡œì§ì„ í•œ ê³³ì— ëª¨ìŒ
â”‚   â”œâ”€â”€ ğŸ“ features                    # í•„í„°, ì •ë ¬ ë“±ì˜ slice íŒŒì¼
â”‚   â”‚   â””â”€â”€ ğŸ“„ filterSlice.ts                  
â”‚   â”œâ”€â”€ ğŸ“„ hooks.ts                    # íƒ€ì…ì„ ì–¸ì„ ìœ„í•´ì„œ ì»¤ìŠ¤í…€ í›… ìƒì„±
â”‚   â””â”€â”€ ğŸ“„ store.ts                    # ì €ì¥ì†Œ         
```

<br/>

# ì˜ˆì‹œ ì½”ë“œ
## 1. state ì €ì¥ì†Œ êµ¬ì„±: `store.ts`
- `store.ts`: ëª¨ë“  stateê°€ ì €ì¥ë˜ëŠ” `ì €ì¥ì†Œ`
```js
// redux/store.ts
import { configureStore } from '@reduxjs/toolkit';
import filterReducer from '@/redux/features/filterSlice'; // 'ì´ë¦„Reducer' í˜•íƒœë¡œ ë³„ëª… ë¶™ì„

export const store = configureStore({
  reducer: {
    filter: filterReducer,
    // ... ë” ì¶”ê°€ ê°€ëŠ¥
  }
});

export type RootState = ReturnType<typeof store.getState>;
export type AppDispatch = typeof store.dispatch;
```

## 2. íƒ€ì… ì§€ì› ì»¤ìŠ¤í…€ hooks: `hooks.ts`
- Redux Toolkit + React + TypeScript í™˜ê²½ì—ì„œ typed hooksë¥¼ ì„ ì–¸
- í”„ë¡œì íŠ¸ì˜ ëª¨ë“  ì»´í¬ë„ŒíŠ¸ì—ì„œ ì†ì‰½ê³  ì•ˆì •ì ìœ¼ë¡œ Redux ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤Œ.

```js
import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';
import type { RootState, AppDispatch } from './store';

export const useAppDispatch = () => useDispatch<AppDispatch>();
export const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;
```

## 3. stateë¥¼ ê´€ë¦¬ ê°ì²´ ìƒì„±: `slice.ts`
- ì „í†µ Reduxì—ì„œëŠ” action, actionCreator, reducerë¥¼ ë”°ë¡œ ë§Œë“œëŠë¼ ì½”ë“œê°€ ê¸¸ì—ˆì§€ë§Œ, RTKì—ì„œëŠ” createSlice() í•œ ì¤„ë¡œ ëª¨ë‘ í•´ê²°

```js
// redux/features/filterSlice.ts
import { createSlice, PayloadAction } from '@reduxjs/toolkit';

interface FilterState {
  category: string[];
  priceRange: [number, number] | null;
}
const initialState: FilterState = {
  category: [],
  priceRange: null,
};

// ìì„¸í•œ ë‚´ìš©ì€ ì½”ë“œ ì•„ë˜ ì°¸ê³ 
const filterSlice = createSlice({
  name: 'filter',
  initialState,
  reducers: {
    setCategory(state, action: PayloadAction<string[]>) {
      state.category = action.payload;
    },
    setPriceRange(state, action: PayloadAction<[number, number] | null>) {
      state.priceRange = action.payload;
    },
    clearFilters(state) {
      state.category = [];
      state.priceRange = null;
    },
  },
});

// filterSlice.actions: RTKê°€ ìë™ ìƒì„±í•œ action creator í•¨ìˆ˜ ëª¨ìŒ
// dispatch(...)ë¥¼ í˜¸ì¶œí•˜ë ¤ë©´ action creator í•¨ìˆ˜ê°€ í•„ìš”. ë§Œì•½ slice.reducerë§Œ exportëœë‹¤ë©´, storeì—ëŠ” reducerëŠ” ë“¤ì–´ê°€ì§€ë§Œ ì»´í¬ë„ŒíŠ¸ì—ì„œëŠ” ì–´ë–¤ actionì„ ë³´ë‚´ì•¼ í•˜ëŠ”ì§€ ëª°ë¼ì„œ ìƒíƒœ ì—…ë°ì´íŠ¸ë¥¼ í•  ìˆ˜ ì—†ìŒ.
export const { setCategory, setPriceRange, clearFilters } = filterSlice.actions;

// filterSlice.reducer: storeì— ì—°ê²°ë˜ì–´ ìƒíƒœ ë³€ê²½ ë¡œì§ì„ ìˆ˜í–‰í•˜ëŠ” `ìµœì¢… ë¦¬ë“€ì„œ`
// ì´ í•¨ìˆ˜ëŠ” storeì— ì—°ê²°ë˜ì–´, ì „ë‹¬ëœ actionì„ ê¸°ë°˜ìœ¼ë¡œ stateë¥¼ ì‹¤ì œë¡œ ì—…ë°ì´íŠ¸
export default filterSlice.reducer;
```
<br/>
<img src="../docs/assets/sliceObject.png" alt="Slice Object" width="700px"/>
<br/>
<br/>

- `createSlice({ })`: Slice ë¥¼ ë§Œë“¤ì–´ì£¼ëŠ” í•¨ìˆ˜
  - Slice: RTK(Redux Toolkit) ì—ì„œ ì†Œê°œí•œ ê°œë…ìœ¼ë¡œ, ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒíƒœë¥¼ ê¸°ëŠ¥ ë‹¨ìœ„ë¡œ ìª¼ê°  ì¡°ê°/ë‹¨ìœ„ ex. filter, use, cart ê°™ì€ ê¸°ëŠ¥ë³„ ìƒíƒœ ë©ì–´ë¦¬
  - createSlice({ })ë¥¼ ì‹¤í–‰í•˜ë©´, RTKëŠ” ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìë™ìœ¼ë¡œ 'name, initialState, reducers, extraReducers, reducerPath, selectors' ì„ ë‹´ê³  ìˆëŠ” ê°ì²´ë¥¼ ìƒì„±
- `createSlice.name`: 
  - **íƒ€ì…**: `string`
  - **ì—­í• **: sliceì˜ ì´ë¦„ì„ ì§€ì •. ìƒì„±ëœ action type prefixë¡œ ì‚¬ìš©ë¨ (ì˜ˆ: "filter/setCategory").
- `createSlice.initialState`:   
  - **íƒ€ì…**: ì›í•˜ëŠ” ìƒíƒœ êµ¬ì¡°(Stateíƒ€ì…)
  - **ì—­í• **: ë¦¬ë“€ì„œì˜ ì‹œì‘ ìƒíƒœ
    - undefined ìƒíƒœê°€ ë“¤ì–´ì˜¬ ë•Œ ì´ ê°’ì„ ì‚¬ìš©
    - í•¨ìˆ˜ í˜•íƒœë¡œë„ ì‘ì„± ê°€ëŠ¥, ì˜ˆ: {count: 0} ë˜ëŠ” () => ({ count: 0 })ë¥¼ ë¦¬í„´
- `createSlice.actions`: 
  - **íƒ€ì…**: { actionCreator1(í•¨ìˆ˜1), actionCreator2(í•¨ìˆ˜2), ... }
  - **ì—­í• **: 
    -  ê° reducersì— ëŒ€ì‘í•˜ëŠ” **action creator í•¨ìˆ˜ë“¤ì´ ëª¨ì—¬ ìˆëŠ” ê°ì²´**
      - **action creator**: [*createdSlice*].actions.[*actionCreator1*]: ì—¬ê¸°ì„œì˜ action creatorëŠ” 'setCategory(), setPriceRane(), clearFilters()'ì— í•´ë‹¹
      - **action type**: [*createdSlice*].actions.[*actionCreator1*].type: ê°ê°ì˜ action creatorëŠ” ë¬¸ìì—´ íƒ€ì…ì˜ type ì†ì„±ì„ ê°€ì§€ê³  ìˆìŒ. ì–´ë–¤ ì¢…ë¥˜ì˜ actionì¸ì§€ ì‹ë³„í•˜ëŠ” **ê³ ìœ  ì‹ë³„ì** ì—­í• . Reduxì—ì„œëŠ” typeí•„ë“œë¡œ ì–´ë–¤ reducerê°€ ì´ Actionì„ ì²˜ë¦¬í• ì§€ êµ¬ë¶„. ex) filer/setCategory, (sliceName/caseReducerName) í˜•íƒœë¡œ ìë™ ì €ì¥
    - ë•Œë¬¸ì— exportí• ë•ŒëŠ” createdSlice.reducersê°€ ì•„ë‹ˆë¼, createdSlice.actionsë¥¼ ì¨ì„œ í•¨ìˆ˜ exportí•´ì¤˜ì•¼ í•¨
- `createSlice.reducers`:   
  - **íƒ€ì…**: `{ [key: string]: ReducerFunction | ReducerAndPrepareObject }`
  - **ì—­í• **: 
    - case reducer í•¨ìˆ˜ ëª¨ìŒ
      - case reducer: íŠ¹ì • actioníƒ€ì…ì— ëŒ€ì‘í•˜ëŠ” state ì—…ë°ì´íŠ¸ ë¡œì§ **í•¨ìˆ˜**, actionì´ ë°œìƒí–ˆì„ ë•Œ ìƒíƒœë¥¼ ì–´ë–»ê²Œ ë°”ê¾¸ëŠ”ì§€ caseë‹¨ìœ„ë¡œ ì •ì˜. ì—¬ê¸°ì„œëŠ” setCategory(), setPriceRane(), clearFilters()ê°€ í•´ë‹¹
    - reducerëŠ” ReduxìŠ¤í† ì–´ì˜ ìƒíƒœë¥¼ ê³„ì† ì—…ë°ì´íŠ¸ í•˜ëŠ” í†µí•© í•¨ìˆ˜ (reducersì—ì„œ ì •ì˜í•œ ì—¬ëŸ¬ ë¡œì§ë“¤ì„ ì¼€ì´ìŠ¤ ë³„ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ í•˜ë‚˜ë¡œ í•©ì³ë†“ì€ ë‹¨ í•˜ë‚˜ì˜ **ìµœì¢… ë¦¬ë“€ì„œ í•¨ìˆ˜**ë¡œ ë‚´ë¶€ì ìœ¼ë¡œëŠ” **switch êµ¬ë¬¸ì²˜ëŸ¼ ë™ì‘** => ìŠ¤í† ì–´ì—ì„œ ìƒíƒœ ë³€ê²½ì„ ë‹´ë‹¹)
    - ê° í•¨ìˆ˜ëŠ” (state, action) í˜•íƒœì´ê³ , ë¡œì§ ì‹¤í–‰ ì‹œ stateë¥¼ ì§ì ‘ ìˆ˜ì •í•˜ëŠ” ê²ƒì²˜ëŸ¼ ì‘ì„±í•˜ì§€ë§Œ, ë‚´ë¶€ì ìœ¼ë¡œëŠ” ë¶ˆë³€ì„±(i.e., Immer)ì´ ë³´ì¥
    - key ì´ë¦„ì€ action creator ì´ë¦„ì´ ë˜ë©°, slice.actions[thatName] í˜•íƒœë¡œ ì ‘ê·¼ ê°€ëŠ¥
- `createSlice.caseReducers`                                    
  - **ì—­í• **: ì›ë˜ ì •ì˜í•œ reducers í•¨ìˆ˜ë“¤ ì›ë³¸
- `createSlice.extraReducers`
  - **íƒ€ì…**:
    - ì½œë°± ë°©ì‹: (builder) => void
    - ë˜ëŠ” ê°ì²´ í˜•íƒœ { [actionType]: caseReducer }
  - **ì—­í• **:
    - ì´ sliceì—ì„œ ì •ì˜í•˜ì§€ ì•Šì€ ì™¸ë¶€ action typeì„ ì²˜ë¦¬í•  ë•Œ ì‚¬ìš©.
    - createAsyncThunkë¡œ ìƒì„±ëœ action(pending/fulfilled/rejected ë“±) ì²˜ë¦¬ì— ì£¼ë¡œ ì‚¬ìš©
- ê·¸ ì™¸: reducerPath, selectors
  - **reducerPath**: sliceì˜ ê²½ë¡œë¥¼ ì§€ì •í•˜ë©°, ì£¼ë¡œ RTK Queryì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤. ê¸°ë³¸ê°’ì€ nameê³¼ ë™ì¼í•©ë‹ˆë‹¤.
  - **selectors**: slice ìƒíƒœë¥¼ ì‰½ê²Œ ì¡°íšŒí•˜ê¸° ìœ„í•œ selector í•¨ìˆ˜ë¥¼ ë¯¸ë¦¬ ì •ì˜í•´ ì¤„ ìˆ˜ ìˆìŒ


## 4. Redux Provider ë˜í¼ ìƒì„±: `StoreProvider.tsx`
- ëª¨ë“  ê³³ì—ì„œ Redux ì˜ ìƒíƒœ ê°’ í˜¸ì¶œ ê°€ëŠ¥í•˜ë„ë¡ ì»¤ìŠ¤í…€ Provider ì»´í¬ë„ŒíŠ¸ ìƒì„±
- ìƒíƒœ ê´€ë¦¬ ê´€ë ¨ëœ ì»´í¬ë„ŒíŠ¸ëŠ” CSR (Client Side Redering)ì´ë¯€ë¡œ í•­ìƒ `use client` ë¶™ì—¬ì•¼ í•¨.

```js
// app/StoreProvider.tsx
'use client';
import { Provider } from 'react-redux';
import { store } from '../redux/store';
import { ReactNode } from 'react';

export default function StoreProvider({ children }: { children: ReactNode }) {
  return <Provider store={store}>{children}</Provider>;
}
```

## 5. Provider ì—°ê²°: `layout.tsx`
- Provider wrapper ë¡œ ê°ì‹¸ì„œ í˜ì´ì§€ ì „ì²´ì—ì„œ Reduxìƒíƒœë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë§Œë“¤ê¸°

```js
// app/layout.tsx
import StoreProvider from './StoreProvider';
exp
ort default function RootLayout({ children }: { children: React.ReactNode }) {
  return (
    <html>
      <body>
        <StoreProvider>{children}</StoreProvider>
      </body>
    </html>
  );
}
```

## 6. ì»´í¬ë„ŒíŠ¸ì—ì„œ redux ì‚¬ìš©
```js
'use client';
import { useAppSelector, useAppDispatch } from '@/redux/hooks';
import { setCategory, clearFilters } from '@/redux/features/filterSlice';

const Sidebar = () => {
  const categories = useAppSelector(state => state.filter.category);
  const dispatch = useAppDispatch();

  return (
    <div>
      {['Food', 'Drink', 'Snack'].map(cat => (
        <label key={cat}>
          <input
            type="checkbox"
            checked={categories.includes(cat)}
            onChange={() => dispatch(
              categories.includes(cat)
                ? setCategory(categories.filter(c => c !== cat))
                : setCategory([...categories, cat])
            )}
          />
          {cat}
        </label>
      ))}
      <button onClick={() => dispatch(clearFilters())}>Reset</button>
    </div>
  );
};

```

------------

# ì´ì „ì— ì‘ì„±í–ˆë˜ ë‚´ìš©
```js
(store.js)
// 1. src/store.js ìƒì„± ë° ì•„ë˜ ì½”ë“œ ë³µë¶™
import { configureStore, createSlice } from '@reduxjs/toolkit'

export default configureStore({
  reducer: { 
  }
}) 

(index.js)
// 2. import
import store from './store.js'

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  // 3. <Provider store={store}></Provider>ë¡œ ê°ì‹¸ê¸°
  <Provider store={store}>
    <React.StrictMode>
      <BrowserRouter>
        <App />
      </BrowserRouter>
    </React.StrictMode>
  </Provider>
);
```

### ì‚¬ìš©ë²•
1. storeì— ë‹¨ìˆœ ê°ì²´ ë³´ê´€ 
- storeì— state ë³´ê´€ë²•
```JavaScript
(store.js)
import { configureStore, createSlice } from '@reduxjs/toolkit'

// 1. createSlice() ì‚¬ìš©í•´ì„œ ì €ì¥í•˜ê³  ì‹¶ì€ stateë§Œë“¤ê¸°. (createSlice()ì™€ useState()ê°€ ìš©ë„ë¹„ìŠ·)
// { name : 'stateì´ë¦„', initialState : 'stateê°’' }
let userName = createSlice({
  name: "userName",
  initialState: "Kim" 
})

// 2. configureStore()ì— ìƒì„±í•œ state ë“±ë¡. ì—¬ê¸° ë“±ë¡í•œ stateëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ììœ ë¡­ê²Œ ì‚¬ìš©ê°€ëŠ¥
// { ì‘ëª… : createSliceë§Œë“ ê±°.reducer } 
export default configureStore({
  reducer: { 
    userName: userName.reducer
  }
});
```
- storeì— ì €ì¥ëœ state ì‚¬ìš©ë²•
```JavaScript
(Cart.js)
// 1. import useSelector()
import { useSelector } from 'react-redux';

function Cart() {
  // 2. useSelector()ì´ìš©í•˜ì—¬ storeì— ìˆëŠ” ëª¨ë“  stateê°€ì ¸ì˜´.
  // ì•„ë˜ 3ê°€ì§€ ë‹¤ ë™ì¼í•œ ê²°ê³¼ê°’. í¸í•œê²ƒìœ¼ë¡œ ì‚¬ìš©
  let {userName} = useSelector( (state)=>{ state } );
  let userName1 = useSelector( (state)=>{ return state.userName });
  let userName2 = useSelector( (state)=> state.userName );
  
  console.log(userName); // ê²°ê³¼ê°’: Kim

  return(
    [ìƒëµ]
  )
}
```

2. storeì— í•¨ìˆ˜ ì¶”ê°€: initialState ê°€ object/arrayê°€ ì•„ë‹Œê²½ìš°
- storeì— state ë³´ê´€ë²•
```JavaScript
(store.js)
import { configureStore, createSlice } from '@reduxjs/toolkit'

// 1. createSlice() ì‚¬ìš©: ì´ˆê¸° ê°’ì€ initialStateì— ì €ì¥í•˜ê³  , í•¨ìˆ˜ëŠ” reducers :{} ì•ˆì— ì¶”ê°€
let userName = createSlice({
  name: "userName",
  initialState: "Kim",
  reducers: {
    // 2. ì¶”ê°€í•˜ê³  ì‹¶ì€ í•¨ìˆ˜ëŠ” reducersì— ì¶”ê°€, í•¨ìˆ˜ íŒŒë¼ë¯¸í„°ë¡œ initialState ì ‘ê·¼ ê°€ëŠ¥
    // initialStateê°€ object/arrayê°€ ì•„ë‹Œ ê²½ìš° stateë¡œ ë°”ë¡œ í˜¸ì¶œ
    changeName(state) {
      return "John" + state // John Kim
    },
    fun1(state){
      return 'test'
    }
  } 
})
// 3. ìƒì„±í•œ í•¨ìˆ˜ë“¤ ë‚´ë³´ë‚´ê¸°
export let { changeName, fun1 } = userName.actions

// 4. configureStore()ì— ìƒì„±í•œ state ë“±ë¡. ì—¬ê¸° ë“±ë¡í•œ stateëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ììœ ë¡­ê²Œ ì‚¬ìš©ê°€ëŠ¥
// { ì‘ëª… : createSliceë§Œë“ ê±°.reducer } 
export default configureStore({
  reducer: { 
    userName : userName.reducer
  }
}) 
```
- storeì— ì €ì¥ëœ state ì‚¬ìš©ë²• 
```JavaScript
(Child.js)
// 1. í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸° ìœ„í•´ useDispatch() ê°€ì ¸ì˜¤ê¸° + storeì— ì €ì¥ëœ í•¨ìˆ˜ ê°€ì ¸ì˜¤ê¸° 
import { useSelector, useDispatch } from 'react-redux';
import { changeName } from '../store';

function Child() {
  let userName = useSelector( (state)=> state.userName );
  // 2. useDispatch() ì„ ì–¸: store.jsë¡œ ìš”ì²­ë³´ë‚´ì£¼ëŠ” í•¨ìˆ˜
  let dispatch = useDispatch();

  return(
    <>
      // 3. ì‚¬ìš©: dispatch()ë¥¼ í†µí•´ì„œ changeName()í˜¸ì¶œ
      <button onClick={ ()=> dispatch( changeName() ) }>ë³€ê²½</button>
      <p>{userName}</p> // ì²˜ìŒì—ëŠ” Kimì´ê³ , ìœ„ì— ë²„íŠ¼ ëˆ„ë¥´ë©´ John Kimìœ¼ë¡œ ë³€ê²½
    </>
  )
}
```

3. storeì— ë³€ê²½ í•¨ìˆ˜ ì¶”ê°€: initialState ê°€ object/arrayì¸ ê²½ìš°
- storeì— state ë³´ê´€ë²•
```JavaScript
(store.js)
import { configureStore, createSlice } from '@reduxjs/toolkit'

// 1. createSlice() ì‚¬ìš©: ì´ˆê¸° ê°’ì€ initialStateì— ì €ì¥í•˜ê³  , í•¨ìˆ˜ëŠ” reducers :{} ì•ˆì— ì¶”ê°€
let user = createSlice({
  name: "user",
  initialState: { name: "Kim", age: 20 },
  reducers: {
    // 2. ì¶”ê°€í•˜ê³  ì‹¶ì€ í•¨ìˆ˜ëŠ” reducersì— ì¶”ê°€, í•¨ìˆ˜ íŒŒë¼ë¯¸í„°ë¡œ initialState ì ‘ê·¼ ê°€ëŠ¥
    // initialStateê°€ object/arrayì¸ ê²½ìš°ëŠ” state.OBJECT_KEYë¡œ ì ‘ê·¼
    changeName(state) {
      state.name = "park" // Immer.jsë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìë™ìœ¼ë¡œ ì„¤ì¹˜ê°€ ë˜ì–´ì„œ, ì•Œì•„ì„œ state ë³µì‚¬ë³¸ì„ ë³µì‚¬í•´ì„œ ë¦¬í„´í•´ì¤Œ
    },
    incAge(state) {
      state.age += 1
    }
  } 
})
// 3. ìƒì„±í•œ í•¨ìˆ˜ë“¤ ë‚´ë³´ë‚´ê¸°
export let { changeName, incAge } = user.actions

// 4. configureStore()ì— ìƒì„±í•œ state ë“±ë¡. 
export default configureStore({
  reducer: { 
    user : user.reducer
  }
}) 
```
- storeì— ì €ì¥ëœ state ì‚¬ìš©ë²• 
```JavaScript
(Child.js)
// 1. í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸° ìœ„í•´ useDispatch() ê°€ì ¸ì˜¤ê¸° + storeì— ì €ì¥ëœ í•¨ìˆ˜ ê°€ì ¸ì˜¤ê¸° 
import { useSelector, useDispatch } from 'react-redux';
import { incAge } from '../store';

function Child() {
  // 2. stateê°’ ê°€ì ¸ì˜¤ê¸° + stateì˜ ì €ì¥ í•¨ìˆ˜ ì“¸ ì¤€ë¹„
  let user = useSelector( (state)=> state.user );
  let dispatch = useDispatch();

  return(
    <>
      // 3. ì‚¬ìš©
      <button onClick={ ()=>dispatch(incAge()) }>ë‚˜ì´ í•œì‚´ ì¶”ê°€</button>
      <p>{user.age}</p> // ê²°ê³¼ ê°’: 20 -> 21
    </>
  )
}
```

4. storeì˜ í•¨ìˆ˜ í˜¸ì¶œ ì‹œ, íŒŒë¼ë¯¸í„°ë¡œ ê°’ì„ ì „ë‹¬ë°›ê³  ì‹¶ì€ ê²½ìš°
- storeì— state ë³´ê´€ë²•
```JavaScript
(store.js)
import { configureStore, createSlice } from '@reduxjs/toolkit'

// 1. createSlice() ì‚¬ìš©: ì´ˆê¸° ê°’ì€ initialStateì— ì €ì¥í•˜ê³  , í•¨ìˆ˜ëŠ” reducers :{} ì•ˆì— ì¶”ê°€
let user = createSlice({
  name: "user",
  initialState: { name: "Kim", age: 20 },
  reducers: {
    // 2. ì¶”ê°€í•˜ê³  ì‹¶ì€ í•¨ìˆ˜ëŠ” reducersì— ì¶”ê°€
    // state: initialStateì˜ ê°’, action.payload: íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ì€ ê°’
    incAge(state, action) {
      state.age += action.payload
    }
  } 
})
// 3. ìƒì„±í•œ í•¨ìˆ˜ë“¤ ë‚´ë³´ë‚´ê¸°
export let { incAge } = user.actions

// 4. configureStore()ì— ìƒì„±í•œ state ë“±ë¡
export default configureStore({
  reducer: { 
    user : user.reducer
  }
}) 
```

- storeì— ì €ì¥ëœ state ì‚¬ìš©ë²• 
```JavaScript
(Child.js)
// 1. í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸° ìœ„í•´ useDispatch() ê°€ì ¸ì˜¤ê¸° + storeì— ì €ì¥ëœ í•¨ìˆ˜ ê°€ì ¸ì˜¤ê¸° 
import { useSelector, useDispatch } from 'react-redux';
import { incAge } from '../store';

function Child() {
  // 2. stateê°’ ê°€ì ¸ì˜¤ê¸° + stateì˜ ì €ì¥ í•¨ìˆ˜ ì“¸ ì¤€ë¹„
  let user = useSelector( (state)=> state.user );
  let dispatch = useDispatch();

  return(
    <>
      // 3. ì‚¬ìš©: dispatch()ë¥¼ í†µí•´ì„œ changeName(PAYLOAD)í˜¸ì¶œ
      <button onClick={ ()=>dispatch(incAge(5)) }>ë‚˜ì´ 5ì‚´ ì¶”ê°€</button>
      <p>{user.age}</p> // ê²°ê³¼ ê°’: 20 -> 25
    </>
  )
}
```

### Import/Export
store.jsê°€ ë„ˆë¬´ ê¸¸ì–´ì ¸ì„œ íŒŒì¼ ë¶„ë¦¬í•˜ê³  ì‹¶ë‹¤ë©´? => ì˜ˆë¥¼ë“¤ì–´, store.js ë¶€ë¶„ ì¤‘ userë¶€ë¶„ ë¶„ë¦¬í•˜ê³  ì‹¶ìŒ.   

Step 1. src ë°‘ì— í´ë”ë‘ íŒŒì¼ ìƒˆë¡œ ë§Œë“¤ê¸°: src/store/[Sliceì´ë¦„]Slice.js ex) userSlice.js   
Step 2. ë¶„ë¦¬í•˜ê³  ì‹¶ì€ ì½”ë“œ ì˜ë¼ì„œ ìƒˆë¡œìš´ íŒŒì¼ì— ë¶™ì—¬ë„£ê³ , createSlice()ë“± í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ import
```Javascript
(userSlice.js)
// 1. í•„ìš”í•œ í•¨ìˆ˜ë“¤ import
import { createSlice } from "@reduxjs/toolkit"

// 2. createSlice()í•¨ìˆ˜
let user = createSlice({
  name: "user",
  initialState: { name: "Kim", age: 20 },
  reducers: {
    changeName(state) {
      state.name = "park"
    },
    incAgeBy1(state) {
      state.age += 1
    },
    incAge(state, action) {
      state.age += action.payload
    }
  } 
})
// 3. ë‹¤ë¥¸ ê³³ì—ì„œ ì“°ê¸° ìœ„í•´ì„œ í•¨ìˆ˜(actions) export
export let { changeName, incAgeBy1, incAge } = user.actions

// 4. ë‹¤ë¥¸ ê³³ì—ì„œ ì“°ê¸° ìœ„í•´ì„œ ê°ì²´ export
export default user
```
Step 4. store.jsì—ì„œ import
```JavaScript
(store.js)
// 1. ì˜ë¼ëƒˆë˜ userSlice import
import user from './store/userSlice'

[ìƒëµ]

// 2. configureStore()ì— ì €ì¥
export default configureStore({
  reducer: { 
    user : user.reducer,
    [ìƒëµ]
  }
}) 
```

Step 5. ë‹¤ë¥¸ê³³ì—ì„œ user state ì“°ê³  ì‹¶ì„ ë•Œ ì´ì „ê³¼ ë™ì¼í•˜ê²Œ ì‚¬ìš©. but, import ê²½ë¡œê°€ store.jsê°€ ì•„ë‹Œ [Sliceì´ë¦„]Slice.jsì„.
```JavaScript
(Child.js)
// 1. í•¨ìˆ˜ ì‚¬ìš©í•˜ê¸° ìœ„í•´ useDispatch() ê°€ì ¸ì˜¤ê¸° + storeì— ì €ì¥ëœ í•¨ìˆ˜ ê°€ì ¸ì˜¤ê¸° 
import { useSelector, useDispatch } from 'react-redux';
import { incAge } from '../store/userSlice';

function Child() {
  // 2. stateê°’ ê°€ì ¸ì˜¤ê¸° + stateì˜ ì €ì¥ í•¨ìˆ˜ ì“¸ ì¤€ë¹„
  let user = useSelector( (state)=> state.user );
  let dispatch = useDispatch();

  return(
    <>
      // 3. ì‚¬ìš©: dispatch()ë¥¼ í†µí•´ì„œ changeName(PAYLOAD)í˜¸ì¶œ
      <button onClick={ ()=>dispatch(incAge(5)) }>ë‚˜ì´ 5ì‚´ ì¶”ê°€</button>
      <p>{user.age}</p> // ê²°ê³¼ ê°’: 20 -> 25
    </>
  )
}
```

> [!Note]
> Redux storeì•ˆì— ëª¨ë“ ê±¸ ë„£ì§€ëŠ” ë§ê¸°! ì»´í¬ë„ŒíŠ¸ê°„ ê³µìœ ê°€ í•„ìš”ì—†ìœ¼ë©´ ê·¸ëƒ¥ useState()ì“°ë©´ ë˜ë‹ˆê¹.

### Redux ì—ì„œ api í˜¸ì¶œí•œ ê²°ê³¼ ì €ì¥í•˜ê³  ì‹¶ì„ ë•Œ
ê°œë°œí•˜ë‹¤ë³´ë©´ ì „ì—­ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” apië¥¼ í˜¸ì¶œí•˜ê±°ë‚˜, api í˜¸ì¶œí•œ ê²°ê³¼ë¥¼ ì—¬ëŸ¬ êµ°ë°ì—ì„œ ì‚¬ìš©í•´ì•¼ í•  ìƒí™©ì´ ìƒê¸°ëŠ”ë°, ì´ì™€ ê°™ì€ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ redux storeì—ì„œëŠ” ìì²´ì ìœ¼ë¡œ í•˜ì§€ ëª»í•¨.   
=> Reduxë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” redux-thunk, redux-sagaì™€ ê°™ì€ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•´ì„œ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ì§„í–‰   
=> í•˜ì§€ë§Œ, ìœ„ì˜ ê¸°ëŠ¥ë“¤ ê°™ì€ ê²½ìš° Reduxì™€ ê°™ì´ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ëŸ¬ë‹ì»¤ë¸Œê°€ ì¡°ê¸ˆ ìˆê¸° ë•Œë¬¸ì—, Redux Toolkitì˜ createAsyncThunkë¥¼ ì‚¬ìš©í•´ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ì§„í–‰

- createAsyncThunk() ì‚¬ìš©ë²•   
Promiseì˜ 3ê°€ì§€ ìƒíƒœì™€ ê°™ì´ pending, fulfilled, rejectedì˜ ìƒíƒœë¥¼ ê°–ìŒ
```JavaScript
import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';
import axios from 'axios';

// 1. CreateAsyncThunkë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„° ê°€ì ¸ì˜´
export const fetchSkills = createAsyncThunk(
  'skills/fetchSkills',
  async () => {
    const response = await axios.get('/data/skills/skills.json');
    return response.data.skills;
  }
);

// 2. extraReducersë¼ëŠ” ê²ƒì„ í†µí•´ì„œ createAsyncThunkë¡œ ìƒì„±í•œ Thunk ë“±ë¡ (Redux ìì²´ì ìœ¼ë¡œëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŒ)
const skillsSlice = createSlice({
  name: 'skills',
  initialState: {
    items: [],
    status: 'idle',
    error: null
  },
  reducers: {},
  extraReducers: (builder) => {
    builder
      .addCase(fetchSkills.pending, (state) => {
        state.status = 'loading';
      })
      .addCase(fetchSkills.fulfilled, (state, action) => {
        state.status = 'succeeded';
        state.items = action.payload;
      })
      .addCase(fetchSkills.rejected, (state, action) => {
        state.status = 'failed';
        state.error = action.error.message;
      });
  }
});

export default skillsSlice.reducer;
```